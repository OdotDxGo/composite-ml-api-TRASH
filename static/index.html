<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤ –∫–æ–º–ø–æ–∑–∏—Ç–æ–≤ - ML + –§–∏–∑–∏–∫–∞</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 15px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }
        
        .badges {
            margin-top: 20px;
        }
        
        .badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 25px;
            margin: 5px;
            font-size: 0.95em;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .section h2 {
            color: #667eea;
            margin-bottom: 25px;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            font-weight: 600;
            margin-bottom: 10px;
            color: #555;
            font-size: 1.05em;
        }
        
        select, input[type="number"] {
            padding: 14px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: border-color 0.3s;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        input[type="range"] {
            flex: 1;
            height: 8px;
            background: linear-gradient(to right, #667eea, #764ba2);
            border-radius: 5px;
            outline: none;
        }
        
        .vf-value {
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            min-width: 70px;
            text-align: center;
        }
        
        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #6A994E 0%, #A7C957 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #F18F01 0%, #FCBF49 100%);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #C73E1D 0%, #A23B72 100%);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .btn:active {
            transform: translateY(-1px);
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .result-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.08);
            border-left: 5px solid #667eea;
        }
        
        .result-label {
            color: #666;
            font-size: 0.95em;
            margin-bottom: 8px;
        }
        
        .result-value {
            font-size: 1.8em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .result-unit {
            color: #888;
            font-size: 0.9em;
        }
        
        .result-ci {
            font-size: 0.85em;
            color: #999;
            margin-top: 8px;
        }
        
        .validation-box {
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
        }
        
        .validation-success {
            background: #d4edda;
            border: 2px solid #28a745;
        }
        
        .validation-warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
        }
        
        .validation-error {
            background: #f8d7da;
            border: 2px solid #dc3545;
        }
        
        .warning-list, .recommendation-list {
            list-style: none;
            padding: 0;
            margin-top: 15px;
        }
        
        .warning-list li, .recommendation-list li {
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 8px;
            border-left: 4px solid;
        }
        
        .warning-list li {
            border-left-color: #ffc107;
        }
        
        .recommendation-list li {
            border-left-color: #28a745;
        }
        
        .plot-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .btn-plot {
            padding: 15px;
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-plot:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
        }
        
        .plot-container {
            margin-top: 20px;
            text-align: center;
            display: none;
        }
        
        .plot-container img {
            max-width: 100%;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }
        
        .spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #667eea;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .hidden {
            display: none;
        }
        
        .info-box {
            background: #e8f4f8;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #667eea;
        }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 1.8em; }
            .form-grid { grid-template-columns: 1fr; }
            .results-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="header">
            <h1>üß¨ –ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤ –∫–æ–º–ø–æ–∑–∏—Ç–æ–≤</h1>
            <p>–§–∏–∑–∏–∫–∞ + Machine Learning –¥–ª—è –Ω–∞—É—á–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π</p>
            <div class="badges">
                <span class="badge">ü§ñ R¬≤ = 0.924</span>
                <span class="badge">üìä 7 —Å–≤–æ–π—Å—Ç–≤</span>
                <span class="badge">üî¨ –°–∏–º—É–ª—è—Ü–∏—è –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π</span>
                <span class="badge">üìÑ PDF –æ—Ç—á—ë—Ç—ã</span>
                <span class="badge">üéì –î–ª—è Scopus Q1-Q2</span>
            </div>
        </div>

        <div class="content">
            <!-- –°–µ–∫—Ü–∏—è 1: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞—Ç–µ—Ä–∏–∞–ª–∞ -->
            <div class="section">
                <h2>‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–ø–æ–∑–∏—Ç–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞</h2>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>–¢–∏–ø –≤–æ–ª–æ–∫–Ω–∞</label>
                        <select id="fiber">
                            <option value="E-Glass">E-Glass (–°—Ç–µ–∫–ª–æ–≤–æ–ª–æ–∫–Ω–æ)</option>
                            <option value="Carbon T300" selected>Carbon T300 (–£–≥–ª–µ–≤–æ–ª–æ–∫–Ω–æ)</option>
                            <option value="Kevlar 49">Kevlar 49 (–ê—Ä–∞–º–∏–¥–Ω–æ–µ)</option>
                            <option value="Basalt">Basalt (–ë–∞–∑–∞–ª—å—Ç–æ–≤–æ–µ)</option>
                            <option value="Flax">Flax (–õ—å–Ω—è–Ω–æ–µ, –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–µ)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–¢–∏–ø –º–∞—Ç—Ä–∏—Ü—ã</label>
                        <select id="matrix">
                            <option value="Polyester">Polyester (–ü–æ–ª–∏—ç—Ñ–∏—Ä–Ω–∞—è)</option>
                            <option value="Epoxy" selected>Epoxy (–≠–ø–æ–∫—Å–∏–¥–Ω–∞—è)</option>
                            <option value="Vinyl Ester">Vinyl Ester (–í–∏–Ω–∏–ª—ç—Ñ–∏—Ä–Ω–∞—è)</option>
                            <option value="PEEK">PEEK (–í—ã—Å–æ–∫–æ—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è)</option>
                            <option value="Polyamide 6">Polyamide 6 (–¢–µ—Ä–º–æ–ø–ª–∞—Å—Ç–∏—á–Ω–∞—è)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–°—Ö–µ–º–∞ —É–∫–ª–∞–¥–∫–∏</label>
                        <select id="layup">
                            <option value="Unidirectional 0¬∞">–û–¥–Ω–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è 0¬∞</option>
                            <option value="Woven 0/90">–¢–∫–∞–Ω–∞—è 0/90</option>
                            <option value="Quasi-isotropic [0/45/90/-45]" selected>–ö–≤–∞–∑–∏–∏–∑–æ—Ç—Ä–æ–ø–Ω–∞—è [0/45/90/-45]</option>
                            <option value="Angle-ply [¬±45]">–£–≥–ª–æ–≤–∞—è [¬±45]</option>
                            <option value="Cross-ply [0/90]">–ü–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω–∞—è [0/90]</option>
                            <option value="Random Mat">–°–ª—É—á–∞–π–Ω—ã–π –º–∞—Ç</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–ú–µ—Ç–æ–¥ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞</label>
                        <select id="manufacturing">
                            <option value="Autoclave" selected>–ê–≤—Ç–æ–∫–ª–∞–≤ (–ü—Ä–µ–º–∏—É–º)</option>
                            <option value="VARTM">VARTM (–í–∞–∫—É—É–º–Ω–∞—è –∏–Ω—Ñ—É–∑–∏—è)</option>
                            <option value="RTM">RTM (–¢—Ä–∞–Ω—Å—Ñ–µ—Ä–Ω–æ–µ —Ñ–æ—Ä–º–æ–≤–∞–Ω–∏–µ)</option>
                            <option value="Compression Molding">–ö–æ–º–ø—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–µ —Ñ–æ—Ä–º–æ–≤–∞–Ω–∏–µ</option>
                            <option value="Hand Layup">–†—É—á–Ω–∞—è –≤—ã–∫–ª–∞–¥–∫–∞</option>
                            <option value="Filament Winding">–ù–∞–º–æ—Ç–∫–∞</option>
                            <option value="Pultrusion">–ü—É–ª—Ç—Ä—É–∑–∏—è</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>–û–±—ä—ë–º–Ω–∞—è –¥–æ–ª—è –≤–æ–ª–æ–∫–Ω–∞ (Vf)</label>
                    <div class="slider-container">
                        <input type="range" id="vf" min="0.25" max="0.70" step="0.01" value="0.60">
                        <span class="vf-value" id="vfDisplay">0.60</span>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="predictProperties()">
                    üöÄ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å–≤–æ–π—Å—Ç–≤–∞ (ML + –§–∏–∑–∏–∫–∞)
                </button>
            </div>

            <!-- –°–µ–∫—Ü–∏—è 2: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è -->
            <div class="section hidden" id="resultsSection">
                <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</h2>
                
                <div class="info-box" id="methodInfo"></div>
                
                <div class="results-grid" id="resultsGrid"></div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è 3: –í–∞–ª–∏–¥–∞—Ü–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ -->
            <div class="section">
                <h2>‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</h2>
                <p style="margin-bottom: 20px; color: #666;">
                    –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ fiber-matrix-manufacturing –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
                </p>
                
                <button class="btn btn-success" onclick="validateMaterial()">
                    üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
                </button>
                
                <div class="loading" id="validationLoading">
                    <div class="spinner"></div>
                    <p>–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...</p>
                </div>
                
                <div id="validationResults" class="hidden"></div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è 4: –ù–∞—É—á–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ -->
            <div class="section">
                <h2>üìà –ù–∞—É—á–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ (300 DPI)</h2>
                <p style="margin-bottom: 20px; color: #666;">
                    Publication-ready –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –Ω–∞—É—á–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π –∏ –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–π
                </p>
                
                <div class="plot-buttons">
                    <button class="btn-plot" style="background: #4A90E2;" onclick="generatePlot('ashby')">
                        üìä Ashby Chart
                    </button>
                    <button class="btn-plot" style="background: #F18F01;" onclick="generatePlot('vf_sensitivity')">
                        üìâ Vf Sensitivity
                    </button>
                    <button class="btn-plot" style="background: #C73E1D;" onclick="generatePlot('failure_envelope')">
                        ‚ö†Ô∏è Failure Envelope
                    </button>
                    <button class="btn-plot" style="background: #6A994E;" onclick="generatePlot('stress_distribution')">
                        üî¨ Stress Distribution
                    </button>
                </div>
                
                <div class="loading" id="plotLoading">
                    <div class="spinner"></div>
                    <p>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞...</p>
                </div>
                
                <div class="plot-container" id="plotContainer">
                    <img id="plotImage" alt="–ì—Ä–∞—Ñ–∏–∫">
                </div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è 5: –ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∞—è —Å–∏–º—É–ª—è—Ü–∏—è -->
            <div class="section">
                <h2>üî¨ –ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∞—è —Å–∏–º—É–ª—è—Ü–∏—è</h2>
                <p style="margin-bottom: 20px; color: #666;">
                    –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ä–∞–∑—Ä—É—à–µ–Ω–∏—è (Tsai-Wu criterion)
                </p>
                
                <div class="form-group" style="margin-bottom: 20px;">
                    <label>–ü—Ä–∏–ª–æ–∂–µ–Ω–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (–ú–ü–∞)</label>
                    <input type="number" id="appliedLoad" value="100" min="10" max="1000" step="10">
                </div>
                
                <button class="btn btn-danger" onclick="runSimulation()">
                    ‚ö° –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é
                </button>
                
                <div class="loading" id="simulationLoading">
                    <div class="spinner"></div>
                    <p>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∏–º—É–ª—è—Ü–∏–∏...</p>
                </div>
                
                <div id="simulationResults" class="hidden"></div>
            </div>

            <!-- –°–µ–∫—Ü–∏—è 6: PDF –æ—Ç—á—ë—Ç -->
            <div class="section">
                <h2>üìÑ –ù–∞—É—á–Ω—ã–π PDF –æ—Ç—á—ë—Ç</h2>
                <p style="margin-bottom: 20px; color: #666;">
                    –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –¥–ª—è –¥–∏—Å—Å–µ—Ä—Ç–∞—Ü–∏–∏ –∏–ª–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ Scopus Q1-Q2
                </p>
                
                <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h3 style="margin-bottom: 15px;">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–∞:</h3>
                    <ul style="margin-left: 20px; line-height: 1.8;">
                        <li>‚úÖ –¢–∏—Ç—É–ª—å–Ω—ã–π –ª–∏—Å—Ç —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π</li>
                        <li>‚úÖ Executive Summary</li>
                        <li>‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</li>
                        <li>‚úÖ –¢–∞–±–ª–∏—Ü–∞ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏—Ö —Å–≤–æ–π—Å—Ç–≤</li>
                        <li>‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (R¬≤, CI)</li>
                        <li>‚úÖ Publication-quality –≥—Ä–∞—Ñ–∏–∫–∏</li>
                        <li>‚úÖ –°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã</li>
                    </ul>
                </div>
                
                <button class="btn btn-warning" onclick="generatePDFReport()">
                    üì• –°–∫–∞—á–∞—Ç—å PDF –æ—Ç—á—ë—Ç
                </button>
                
                <div class="loading" id="reportLoading">
                    <div class="spinner"></div>
                    <p>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF –æ—Ç—á—ë—Ç–∞...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è Vf
        document.getElementById('vf').addEventListener('input', (e) => {
            document.getElementById('vfDisplay').textContent = e.target.value;
        });

        // –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
        function getCurrentConfig() {
            return {
                fiber: document.getElementById('fiber').value,
                matrix: document.getElementById('matrix').value,
                vf: parseFloat(document.getElementById('vf').value),
                layup: document.getElementById('layup').value,
                manufacturing: document.getElementById('manufacturing').value
            };
        }

        // 1. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤
        async function predictProperties() {
            const config = getCurrentConfig();
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Å–µ–∫—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            document.getElementById('resultsSection').classList.remove('hidden');
            document.getElementById('resultsGrid').innerHTML = '<div class="loading"><div class="spinner"></div><p>–†–∞—Å—á—ë—Ç —Å–≤–æ–π—Å—Ç–≤...</p></div>';
            
            try {
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(config)
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayResults(data);
                } else {
                    alert('–û—à–∏–±–∫–∞: ' + data.error);
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message);
            }
        }

        function displayResults(data) {
            // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ—Ç–æ–¥–µ
            const methodInfo = document.getElementById('methodInfo');
            methodInfo.innerHTML = `
                <strong>–ú–µ—Ç–æ–¥:</strong> ${data.method === 'hybrid' ? 'Hybrid PIRF (–§–∏–∑–∏–∫–∞ + ML)' : 'Physics-only'}<br>
                <strong>–í–µ—Å ML:</strong> ${(data.method_weights.ml * 100).toFixed(0)}% 
                <strong>–í–µ—Å –§–∏–∑–∏–∫–∏:</strong> ${(data.method_weights.physics * 100).toFixed(0)}%<br>
                <strong>–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏:</strong> ${data.confidence}
            `;
            
            // –°–≤–æ–π—Å—Ç–≤–∞
            const properties = [
                { key: 'tensile_strength', name: '–ü—Ä–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏–µ', unit: '–ú–ü–∞', icon: 'üí™' },
                { key: 'tensile_modulus', name: '–ú–æ–¥—É–ª—å —É–ø—Ä—É–≥–æ—Å—Ç–∏', unit: '–ì–ü–∞', icon: 'üìè' },
                { key: 'compressive_strength', name: '–ü—Ä–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Å–∂–∞—Ç–∏–µ', unit: '–ú–ü–∞', icon: 'üîΩ' },
                { key: 'flexural_strength', name: '–ü—Ä–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –∏–∑–≥–∏–±', unit: '–ú–ü–∞', icon: 'üåä' },
                { key: 'flexural_modulus', name: '–ú–æ–¥—É–ª—å —É–ø—Ä—É–≥–æ—Å—Ç–∏ –ø—Ä–∏ –∏–∑–≥–∏–±–µ', unit: '–ì–ü–∞', icon: 'üìê' },
                { key: 'ilss', name: 'ILSS', unit: '–ú–ü–∞', icon: '‚úÇÔ∏è' },
                { key: 'impact_energy', name: '–£–¥–∞—Ä–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è', unit: '–î–∂', icon: 'üí•' }
            ];
            
            const grid = document.getElementById('resultsGrid');
            grid.innerHTML = '';
            
            properties.forEach(prop => {
                const value = data.predictions[prop.key];
                const uncertainty = data.uncertainty[prop.key];
                
                const card = document.createElement('div');
                card.className = 'result-card';
                card.innerHTML = `
                    <div class="result-label">${prop.icon} ${prop.name}</div>
                    <div class="result-value">${value.toFixed(2)}</div>
                    <div class="result-unit">${prop.unit}</div>
                    <div class="result-ci">95% CI: [${uncertainty.lower.toFixed(2)}, ${uncertainty.upper.toFixed(2)}]</div>
                `;
                grid.appendChild(card);
            });
        }

        // 2. –í–∞–ª–∏–¥–∞—Ü–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
        async function validateMaterial() {
            const config = getCurrentConfig();
            
            document.getElementById('validationLoading').style.display = 'block';
            document.getElementById('validationResults').classList.add('hidden');
            
            try {
                const response = await fetch('/validate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(config)
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayValidation(data);
                } else {
                    alert('–û—à–∏–±–∫–∞: ' + data.error);
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ' + error.message);
            } finally {
                document.getElementById('validationLoading').style.display = 'none';
            }
        }

        function displayValidation(data) {
            const container = document.getElementById('validationResults');
            container.classList.remove('hidden');
            
            const statusClass = data.is_valid ? 'validation-success' : 
                               (data.compatibility_score > 70 ? 'validation-warning' : 'validation-error');
            
            let html = `
                <div class="validation-box ${statusClass}">
                    <h3>${data.is_valid ? '‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∞–ª–∏–¥–Ω–∞' : '‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã'}</h3>
                    <p style="font-size: 1.2em; margin-top: 10px;">
                        <strong>–û—Ü–µ–Ω–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:</strong> ${data.compatibility_score.toFixed(1)}/100
                    </p>
                </div>
            `;
            
            if (data.warnings.length > 0) {
                html += '<h3 style="color: #ffc107; margin-top: 25px;">‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</h3>';
                html += '<ul class="warning-list">';
                data.warnings.forEach(w => {
                    html += `<li>${w}</li>`;
                });
                html += '</ul>';
            }
            
            if (data.recommendations.length > 0) {
                html += '<h3 style="color: #28a745; margin-top: 25px;">üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h3>';
                html += '<ul class="recommendation-list">';
                data.recommendations.forEach(r => {
                    html += `<li>${r}</li>`;
                });
                html += '</ul>';
            }
            
            container.innerHTML = html;
        }

        // 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
        async function generatePlot(plotType) {
            const config = getCurrentConfig();
            
            document.getElementById('plotLoading').style.display = 'block';
            document.getElementById('plotContainer').style.display = 'none';
            
            try {
                // –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
                const predResponse = await fetch('/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(config)
                });
                const predData = await predResponse.json();
                
                // –ó–∞—Ç–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫
                const plotResponse = await fetch('/generate_plot', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        plot_type: plotType,
                        config: config,
                        predictions: predData.predictions
                    })
                });
                
                if (plotResponse.ok) {
                    const blob = await plotResponse.blob();
                    const url = URL.createObjectURL(blob);
                    document.getElementById('plotImage').src = url;
                    document.getElementById('plotContainer').style.display = 'block';
                } else {
                    alert('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∏–∫–∞');
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞: ' + error.message);
            } finally {
                document.getElementById('plotLoading').style.display = 'none';
            }
        }

        // 4. –ú–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∞—è —Å–∏–º—É–ª—è—Ü–∏—è
        async function runSimulation() {
            const config = getCurrentConfig();
            const appliedLoad = parseFloat(document.getElementById('appliedLoad').value);
            
            document.getElementById('simulationLoading').style.display = 'block';
            document.getElementById('simulationResults').classList.add('hidden');
            
            try {
                const response = await fetch('/simulate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        config: config,
                        applied_load: appliedLoad
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displaySimulation(data);
                } else {
                    alert('–û—à–∏–±–∫–∞: ' + data.error);
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞: ' + error.message);
            } finally {
                document.getElementById('simulationLoading').style.display = 'none';
            }
        }

        function displaySimulation(data) {
            const container = document.getElementById('simulationResults');
            container.classList.remove('hidden');
            
            const statusClass = data.will_fail ? 'validation-error' : 'validation-success';
            
            container.innerHTML = `
                <div class="results-grid" style="margin-top: 20px;">
                    <div class="result-card">
                        <div class="result-label">–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –≤ –≤–æ–ª–æ–∫–Ω–∞—Ö</div>
                        <div class="result-value">${data.stress_fiber.toFixed(1)}</div>
                        <div class="result-unit">–ú–ü–∞</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –≤ –º–∞—Ç—Ä–∏—Ü–µ</div>
                        <div class="result-value">${data.stress_matrix.toFixed(1)}</div>
                        <div class="result-unit">–ú–ü–∞</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–π</div>
                        <div class="result-value">${data.stress_interface.toFixed(1)}</div>
                        <div class="result-unit">–ú–ü–∞</div>
                    </div>
                </div>
                
                <div class="validation-box ${statusClass}" style="margin-top: 20px;">
                    <h3>${data.will_fail ? '‚ùå –†–ê–ó–†–£–®–ï–ù–ò–ï' : '‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û'}</h3>
                    <p style="margin-top: 15px; font-size: 1.1em;">
                        <strong>–ò–Ω–¥–µ–∫—Å —Ä–∞–∑—Ä—É—à–µ–Ω–∏—è:</strong> ${data.failure_index.toFixed(3)}<br>
                        <strong>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:</strong> ${data.safety_factor.toFixed(2)}<br>
                        <strong>–†–µ–∂–∏–º —Ä–∞–∑—Ä—É—à–µ–Ω–∏—è:</strong> ${data.failure_mode}
                    </p>
                </div>
            `;
        }

        // 5. PDF –æ—Ç—á—ë—Ç
        async function generatePDFReport() {
            const config = getCurrentConfig();
            
            document.getElementById('reportLoading').style.display = 'block';
            
            try {
                // –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
                const predResponse = await fetch('/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(config)
                });
                const predData = await predResponse.json();
                
                // –ó–∞—Ç–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç
                const reportResponse = await fetch('/generate_report', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        config: config,
                        predictions: predData.uncertainty
                    })
                });
                
                if (reportResponse.ok) {
                    const blob = await reportResponse.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'composite_analysis_report.pdf';
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                    alert('‚úÖ PDF –æ—Ç—á—ë—Ç —É—Å–ø–µ—à–Ω–æ —Å–∫–∞—á–∞–Ω!');
                } else {
                    alert('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á—ë—Ç–∞');
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞: ' + error.message);
            } finally {
                document.getElementById('reportLoading').style.display = 'none';
            }
        }
    </script>
</body>
</html>
